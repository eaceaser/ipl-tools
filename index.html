<html>
  <head>
    <script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io.connect('http://localhost');

      socket.emit('tracker', {
        command: 'track',
        keywords: window.location.pathname.substring(1).split(',')
      });

      socket.on('tweet', function (data) {
        var json = JSON.parse(data);

        if (!json.user) {
          return;
        }

        var blockquote = document.createElement('blockquote');
        blockquote.className = 'twitter-tweet';
        blockquote.appendChild(
          document.createElement('p').appendChild(
            document.createTextNode(json.text)
          )
        );
        blockquote.appendChild(
          document.createTextNode("â€” " + json.user.name + " (@" + json.user.screen_name + ")")
        );
        var a = document.createElement('a');
        a.href = "https://twitter.com/twitterapi/status/" + json.id_str;
        a.setAttribute('data-datetime', json.created_at);
        a.appendChild(
          document.createTextNode(json.created_at)
        )
        blockquote.appendChild(a);

        $(blockquote).hide();
        $('#tweets').prepend(
          document.createElement("div").appendChild(blockquote)
        );
        $(blockquote).slideDown('slow');
      });
    </script>
  </head>
  <body>
    <div id='tweets' />
    <div>
      <a class="twitter-timeline" href="https://twitter.com/search?q=%23ipl" data-widget-id="268308680506744832">Tweets about "#ipl"</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
  </body>
</html>
